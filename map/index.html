<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
 
        <!-- mui -->
        <link href="../css/mui.min.css" rel="stylesheet"/>
        <link href="../css/main.css" rel="stylesheet"/>
        <style>
			#allmap {
				height:560px;
				width:100%;
			}
        </style>
    </head>
    <body>
        <header class="mui-bar mui-bar-nav">
            <h1 class="mui-title">桥梁资产综合管养平台</h1>
        </header>
        <div class="mui-content">
        	<div id="allmap">
			</div>
		</div>
		<footer>
        	<nav class="mui-bar mui-bar-tab">
	         	<a class="mui-tab-item" href="../task/index.html">
	         		<span class="mui-icon mui-icon-list"></span>
	         		<span class="mui-tab-label">任务</span>
	         	</a>
	         	<a class="mui-tab-item" href="../task/publish.html">
	         		<span class="mui-icon mui-icon-compose"></span>
	         		<span class="mui-tab-label">发布</span>
	         	</a>
	         	<a class="mui-tab-item" href="">
	         		<span class="mui-icon mui-icon-gear"></span>
	         		<span class="mui-tab-label">工作台</span>
	         	</a>
	         	<a class="mui-tab-item" href="">
	         		<span class="mui-icon mui-icon-person"></span>
	         		<span class="mui-tab-label">个人中心</span>
	         	</a>
         	</nav>
        </footer>
    </body>
</html>
<script src="../js/mui.min.js"></script>
<!-- jquery -->
<script type="text/javascript" src="../js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" charset="utf-8">
	mui.plusReady(function() {
		mui.init({
			swipeBack: true
		});
		
		plus.geolocation.getCurrentPosition(initMap,function(e){
        	mui.toast("异常:" + e.message);
    	});
    	
    	//选项卡点击事件
		mui('.mui-bar-tab').on('tap', 'a', function(e) {
			var url = this.getAttribute('href');
			if(url == "")
			{
				return;
			}
			
			mui.openWindow({
				url:url,
				createNew:true,
				show:{
					autoShow: true
				},
				waiting:{
					autoShow:true
				}
			});
		});
	});
	
	function initMap(position){
		var point=new plus.maps.Point(position.coords.longitude,position.coords.latitude);//经纬度点 
	    var map = new plus.maps.Map("allmap"); //创建地图
	    map.centerAndZoom(point,15);
	    
	    var marker = new plus.maps.Marker(point);
	    map.addOverlay(marker);	 
	}
</script>